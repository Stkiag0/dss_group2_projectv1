{% extends "base.html" %}

{% block title %}Risk Assessment Results - Student DSS{% endblock %}

{% block extra_css %}
<style>
    .results-card {
        background: #f8f9fa;
        padding: 25px;
        border-radius: 10px;
        margin-bottom: 25px;
        border-left: 5px solid;
    }
    
    .results-card.high {
        border-left-color: #e74c3c;
        background: #fef5f5;
    }
    
    .results-card.moderate {
        border-left-color: #f39c12;
        background: #fef9f3;
    }
    
    .results-card.low {
        border-left-color: #27ae60;
        background: #f0fdf4;
    }
    
    .metric {
        display: inline-block;
        padding: 10px 20px;
        background: white;
        border-radius: 8px;
        margin: 10px 10px 10px 0;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    
    .metric-label {
        font-size: 0.9em;
        color: #7f8c8d;
        display: block;
    }
    
    .metric-value {
        font-size: 1.5em;
        font-weight: bold;
        color: #2c3e50;
    }
    
    .recommendations {
        background: #fff3cd;
        padding: 20px;
        border-radius: 8px;
        border-left: 4px solid #f39c12;
    }
    
    .recommendations li {
        margin: 10px 0;
        line-height: 1.6;
    }
    
    .score-breakdown {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 15px;
        margin: 20px 0;
    }
    
    .score-item {
        background: white;
        padding: 15px;
        border-radius: 8px;
        text-align: center;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    
    .score-item-label {
        font-size: 0.9em;
        color: #7f8c8d;
        margin-bottom: 5px;
    }
    
    .score-item-value {
        font-size: 2em;
        font-weight: bold;
        color: #667eea;
    }
</style>
{% endblock %}

{% block content %}
<h2 style="color: #2c3e50; margin-bottom: 30px;">ðŸ“Š Risk Assessment Results</h2>

<!-- Risk Level Card -->
<div class="results-card {{ level|lower|replace(' ', '-') }}">
    <h3 style="margin-bottom: 15px;">Risk Classification</h3>
    <div style="font-size: 2em; font-weight: bold;" 
         class="risk-{{ level|lower|replace(' ', '-') }}">
        {{ level }}
    </div>
</div>

<!-- Key Metrics -->
<div style="margin-bottom: 30px;">
    <h3 style="color: #2c3e50; margin-bottom: 15px;">Key Metrics</h3>
    
    <div class="metric">
        <span class="metric-label">Total Risk Score</span>
        <div class="metric-value">{{ score }}/15</div>
    </div>
    
    <div class="metric">
        <span class="metric-label">Failure Probability</span>
        <div class="metric-value" style="color: #e74c3c;">{{ probability }}%</div>
    </div>
</div>

<!-- Score Breakdown -->
<div style="margin-bottom: 30px;">
    <h3 style="color: #2c3e50; margin-bottom: 15px;">Score Breakdown</h3>
    <div class="score-breakdown">
        <div class="score-item">
            <div class="score-item-label">Academic (APS)</div>
            <div class="score-item-value">{{ risk_scores.APS }}</div>
        </div>
        <div class="score-item">
            <div class="score-item-label">Attendance (ARS)</div>
            <div class="score-item-value">{{ risk_scores.ARS }}</div>
        </div>
        <div class="score-item">
            <div class="score-item-label">Family (FSR)</div>
            <div class="score-item-value">{{ risk_scores.FSR }}</div>
        </div>
        <div class="score-item">
            <div class="score-item-label">Lifestyle (LRS)</div>
            <div class="score-item-value">{{ risk_scores.LRS }}</div>
        </div>
    </div>
</div>

<!-- Recommendations -->
<div class="recommendations">
    <h3 style="margin-bottom: 15px;">ðŸ’¡ Recommended Actions</h3>
    <ul style="padding-left: 20px;">
        {% for rec in recommendations %}
        <li>{{ rec }}</li>
        {% endfor %}
    </ul>
</div>

<!-- Action Buttons -->
<div style="margin-top: 30px; text-align: center;">
    <a href="/" style="display: inline-block; padding: 12px 30px; background: #667eea; color: white; 
       text-decoration: none; border-radius: 8px; margin: 5px; font-weight: 600;">
        â¬… Analyze Another Student
    </a>
    <a href="/dashboard" style="display: inline-block; padding: 12px 30px; background: #27ae60; color: white; 
       text-decoration: none; border-radius: 8px; margin: 5px; font-weight: 600;">
        ðŸ“Š View Dashboard
    </a>
</div>

<!-- Student Data Summary (Collapsible) -->
<details style="margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 8px;">
    <summary style="cursor: pointer; font-weight: bold; color: #2c3e50;">
        ðŸ“‹ View Complete Student Data
    </summary>
    <div style="margin-top: 15px;">
        <table style="width: 100%; border-collapse: collapse;">
            <tr>
                <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;"><strong>G1 Grade:</strong></td>
                <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;">{{ student_data.G1 }}</td>
                <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;"><strong>G2 Grade:</strong></td>
                <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;">{{ student_data.G2 }}</td>
            </tr>
            <tr>
                <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;"><strong>Absences:</strong></td>
                <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;">{{ student_data.absences }}</td>
                <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;"><strong>Study Time:</strong></td>
                <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;">{{ student_data.studytime }}</td>
            </tr>
            <tr>
                <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;"><strong>Failures:</strong></td>
                <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;">{{ student_data.failures }}</td>
                <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;"><strong>Family Support:</strong></td>
                <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;">{{ student_data.famsup }}</td>
            </tr>
        </table>
    </div>
</details>
{% endblock %}